{% extends "Echo_app/base.html" %}
{% load static %}

{% block title %}Meu Perfil{% endblock %}

{% block extra_css %}
<!-- Agora s√≥ precisamos carregar o arquivo CSS que corrigimos -->
<link rel="stylesheet" href="{% static 'Echo_app/css/perfil.css' %}?v={% now 'U' %}">
{% endblock %}

{% block content %}

<div class="container" style="max-width: 800px; margin: 0 auto; padding: 20px;">

    <h1 class="main-title">Meu Perfil</h1>

    <div class="perfil-card">

        <!-- CABE√áALHO DO PERFIL -->
        <div class="perfil-header">
            
            <!-- √ÅREA DA FOTO (AVATAR) -->
            <div class="perfil-avatar-container">
                {% if perfil.foto_perfil %}
                    <img class="perfil-avatar" 
                         src="{{ perfil.foto_perfil.url }}" 
                         alt="Foto de Perfil">
                {% else %}
                    <img class="perfil-avatar" 
                         src="https://ui-avatars.com/api/?name={{ request.user.first_name|default:request.user.username }}&background=0D8ABC&color=fff&size=512&font-size=0.5&bold=true" 
                         alt="Avatar Padr√£o">
                {% endif %}

                <!-- √çcone de Editar Foto -->
                <a href="{% url 'Echo_app:perfil_editar' %}" class="edit-avatar-icon" title="Editar foto">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M21.731 2.269a2.64 2.64 0 0 0-3.737 0l-12.72 12.72A1.97 1.97 0 0 0 5.25 15.75v3.626h3.626a1.97 1.97 0 0 0 1.404-.579l12.72-12.72a2.64 2.64 0 0 0 0-3.737ZM7.125 18v1.875H5.25a.375.375 0 0 1-.375-.375v-1.5h1.875ZM18.75 8.25l-7.5-7.5-1.5 1.5 7.5 7.5 1.5-1.5Z" />
                    </svg>
                </a>
            </div>
            
            <!-- INFO DO USU√ÅRIO -->
            <div class="perfil-info">
                <h3 class="saudacao">
                    {{ request.user.first_name }} {{ request.user.last_name }}
                </h3>
                <p class="user-email">{{ request.user.email }}</p>

                {% if perfil.biografia %}
                    <p class="user-bio">{{ perfil.biografia }}</p>
                {% endif %}

                <a href="{% url 'Echo_app:perfil_editar' %}" class="edit-profile-btn">
                    Editar Perfil
                </a>
            </div>
        </div>
        
        <hr class="perfil-divider">

        <!-- CATEGORIAS (Se existirem) -->
        {% if perfil.categorias_de_interesse.exists %}
        <div class="perfil-categorias">
            <h5 class="categorias-title">Meus Interesses</h5>
            <ul class="lista-categorias">
                {% for categoria in perfil.categorias_de_interesse.all %}
                    <li class="categoria-item">{{ categoria.nome }}</li>
                {% endfor %}
            </ul>
        </div>
        <hr class="perfil-divider">
        {% endif %}

        <!-- MENU DE OP√á√ïES -->
        <nav class="menu-opcoes">
            <a class="menu-item" href="{% url 'Echo_app:noticias_curtidas' %}">
                <span class="menu-icon">‚ù§Ô∏è</span> 
                Not√≠cias Curtidas
            </a>

            <a class="menu-item" href="{% url 'Echo_app:noticias_salvas' %}">
                <span class="menu-icon">üîñ</span> 
                Not√≠cias Salvas
            </a>

            <a class="menu-item" href="{% url 'Echo_app:configuracoes_conta' %}">
                <span class="menu-icon">‚öôÔ∏è</span> 
                Configura√ß√µes da Conta
            </a>

            <hr class="menu-divider">

            <a class="menu-item acao-logout" href="{% url 'Echo_app:sair' %}">
                <span class="menu-icon">üö™</span> 
                Sair da Conta
            </a>
            
            <a class="menu-item acao-deletar" href="{% url 'Echo_app:excluir_conta' %}">
                <span class="menu-icon">‚ùå</span> 
                Excluir Conta
            </a>
        </nav>
    </div>
</div>
{% endblock %}