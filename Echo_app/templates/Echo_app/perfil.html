{% extends "Echo_app/base.html" %}
{% load static %}

{% block title %}Meu Perfil{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'Echo_app/css/perfil.css' %}?v={% now 'U' %}">
{% endblock %}

{% block content %}

<div class="container" style="max-width: 800px; margin: 0 auto; padding: 20px;">

    <h1 class="main-title" style="text-align: center; margin-bottom: 30px; font-weight: 800; color: #333;">Meu Perfil</h1>

    <div class="perfil-card" style="background: #fff; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); padding: 40px 20px;">

        <div class="perfil-header" style="display: flex; flex-direction: column; align-items: center; text-align: center;">
            
            <!-- 
                AVATAR GIGANTE (VISUALIZAR) 
                Tamanho: 300px (para compensar o zoom de 0.75 do site)
            -->
            <div class="perfil-avatar-container" 
                 style="
                    position: relative !important; 
                    width: 300px !important; 
                    height: 300px !important; 
                    min-width: 300px !important;
                    min-height: 300px !important;
                    margin: 0 auto 25px auto !important; 
                    border-radius: 50% !important;
                    overflow: hidden !important; /* Corta o que sobrar */
                    border: 8px solid #fff !important;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.2) !important;
                    background: transparent !important;
                    padding: 0 !important;
                 ">
                
                {% if perfil.foto_perfil %}
                    <img id="perfil-avatar-img" 
                         src="{{ perfil.foto_perfil.url }}?v={% now 'U' %}" 
                         alt="Foto de Perfil"
                         style="
                            width: 100% !important; 
                            height: 100% !important; 
                            object-fit: cover !important; /* OBRIGATÃ“RIO: Preenche o cÃ­rculo */
                            border-radius: 0 !important;
                            border: none !important;
                            margin: 0 !important;
                            padding: 0 !important;
                            display: block !important;
                         ">
                {% else %}
                    <img id="perfil-avatar-img" 
                         src="https://ui-avatars.com/api/?name={{ request.user.first_name|default:request.user.username }}&background=0D8ABC&color=fff&size=512&font-size=0.5&bold=true" 
                         alt="Avatar PadrÃ£o" 
                         style="
                            width: 100% !important; 
                            height: 100% !important; 
                            object-fit: cover !important;
                            border: none !important;
                            margin: 0 !important;
                            display: block !important;
                         ">
                {% endif %}

                <!-- BotÃ£o Editar -->
                <a href="{% url 'Echo_app:perfil_editar' %}" title="Editar foto" 
                   style="position: absolute; bottom: 20px; right: 40px; background: #fff; border-radius: 50%; width: 60px; height: 60px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: #333; text-decoration: none; font-size: 28px; z-index: 10;">
                    âœ
                </a>
            </div>
            
            <!-- INFO -->
            <div class="perfil-info" style="width: 100%;">
                <h3 class="saudacao" style="margin: 0; font-weight: 800; font-size: 2rem;">
                    {{ request.user.first_name }} {{ request.user.last_name }}
                </h3>
                <p class="user-email" style="color: #6c757d; margin: 8px 0; font-size: 1.2rem;">{{ request.user.email }}</p>

                {% if perfil.biografia %}
                    <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin: 25px auto; max-width: 650px;">
                        <p style="white-space: pre-line; margin: 0; color: #555; font-size: 1.1rem; line-height: 1.6;">{{ perfil.biografia }}</p>
                    </div>
                {% endif %}

                <div style="margin-top: 30px;">
                    <a href="{% url 'Echo_app:perfil_editar' %}" style="background-color: #333; color: white; padding: 15px 40px; border-radius: 50px; text-decoration: none; font-weight: 700; font-size: 1.1rem; display: inline-block; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                        Editar Perfil
                    </a>
                </div>
            </div>
        </div>
        
        <hr class="perfil-divider" style="margin: 50px 0; border: 0; border-top: 1px solid #eee;">

        <!-- MENU -->
        <nav class="menu-opcoes" style="display: flex; flex-direction: column; gap: 15px;">
            <a class="menu-item" href="{% url 'Echo_app:noticias_curtidas' %}" style="padding: 20px; text-decoration: none; color: #333; display: flex; align-items: center; border-radius: 12px; background-color: #fcfcfc; border: 1px solid #f0f0f0;">
                <span style="margin-right: 20px; font-size: 1.5rem;">â¤ï¸</span> 
                <span style="font-weight: 600; font-size: 1.2rem;">NotÃ­cias Curtidas</span>
            </a>

            <a class="menu-item" href="{% url 'Echo_app:noticias_salvas' %}" style="padding: 20px; text-decoration: none; color: #333; display: flex; align-items: center; border-radius: 12px; background-color: #fcfcfc; border: 1px solid #f0f0f0;">
                <span style="margin-right: 20px; font-size: 1.5rem;">ğŸ”–</span> 
                <span style="font-weight: 600; font-size: 1.2rem;">NotÃ­cias Salvas</span>
            </a>

            <a class="menu-item" href="{% url 'Echo_app:configuracoes_conta' %}" style="padding: 20px; text-decoration: none; color: #333; display: flex; align-items: center; border-radius: 12px; background-color: #fcfcfc; border: 1px solid #f0f0f0;">
                <span style="margin-right: 20px; font-size: 1.5rem;">âš™ï¸</span> 
                <span style="font-weight: 600; font-size: 1.2rem;">ConfiguraÃ§Ãµes da Conta</span>
            </a>

            <hr style="margin: 20px 0; border-top: 1px solid #eee;">

            <a class="menu-item acao-logout" href="{% url 'Echo_app:sair' %}" style="padding: 20px; text-decoration: none; color: #dc3545; display: flex; align-items: center; border-radius: 12px;">
                <span style="margin-right: 20px; font-size: 1.5rem;">ğŸšª</span> 
                <span style="font-weight: 600; font-size: 1.2rem;">Sair da Conta</span>
            </a>
            
            <a class="menu-item acao-deletar" href="{% url 'Echo_app:excluir_conta' %}" style="padding: 20px; text-decoration: none; color: #6c757d; font-size: 1.1rem; display: flex; align-items: center; border-radius: 12px;">
                <span style="margin-right: 20px; font-size: 1.5rem;">âŒ</span> 
                <span>Excluir Conta Permanentemente</span>
            </a>
        </nav>
    </div>
</div>
{% endblock %}